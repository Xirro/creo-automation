<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Login - Creo Automation</title>
  <link rel="stylesheet" href="/public/assets/css/bootstrap.min.css">
  <style>
    body { padding-top: 40px; }
    .login-box { max-width: 480px; margin: 0 auto; }
  </style>
</head>
<body>
  <div class="container login-box">
    <h3>Creo Automation â€” Login</h3>
    <% if (error) { %>
      <div class="alert alert-danger" role="alert" aria-live="polite"><%= error %></div>
    <% } %>
    <form id="loginForm" method="post" action="/login">
      <div class="form-group">
        <label>Username</label>
        <input class="form-control" name="user" placeholder="Username" required />
      </div>
      <div class="form-group">
        <label>Password</label>
        <input class="form-control" name="password" placeholder="Password" type="password" required />
      </div>
      <button id="loginBtn" class="btn btn-primary" type="submit">
        <span id="btnSpinner" class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true" style="display:none;"></span>
        <span id="btnLabel">Login</span>
      </button>

      <!-- Create account button: navigates to the account request page -->
      <a href="/request-account" class="btn btn-secondary ml-2" role="button" aria-label="Create account">Create account</a>          
    </form>
    <script>
      (function() {
        var form = document.getElementById('loginForm');
        var btn = document.getElementById('loginBtn');
        var spinner = document.getElementById('btnSpinner');
        var label = document.getElementById('btnLabel');
        form.addEventListener('submit', function (e) {
          // prevent double-submit UX (allow form to submit normally)
          btn.disabled = true;
          spinner.style.display = 'inline-block';
          label.textContent = 'Logging in...';
        });

        // If the page was rendered with an error (previous login failed), make sure spinner is hidden and button enabled
        if (document.querySelector('.alert.alert-danger')) {
          btn.disabled = false;
          spinner.style.display = 'none';
          label.textContent = 'Login';
        }
      })();
    </script>
    <p class="mt-3 text-muted small">Credentials are not stored in the repository. For server installs use the installer to save an encrypted password.</p>
  </div>
</body>
</html>